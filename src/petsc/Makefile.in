include @PETSC_INCLUDE_FILE_GENERIC@
include @SLEPC_INCLUDE_FILE_GENERIC@
include sources.make

# the following provides CCPPFLAGS, CLINKER, CC_INCLUDES, SLEPC_INCLUDE, SLEPC_LIB
#include $(SLEPC_DIR)/conf/slepc_common

INCPATHS = @INCLUDEFLAGS@ ${PETSC_CC_INCLUDES} ${SLEPC_CC_INCLUDES}

OBJS_REAL=$(SOURCES:.cpp=.real.o)
OBJS_COMPLEX=$(SOURCES:.cpp=.complex.o)
TARGET_REAL=libncpapetsc_real.a
TARGET_COMPLEX=libncpapetsc_complex.a


real: $(TARGET_REAL)
complex: $(TARGET_COMPLEX)

.PHONY: clean

# link	
$(TARGET_REAL): $(OBJS_REAL)
	ar curv $@ $^
	cp $@ ../../lib
	
$(TARGET_COMPLEX): $(OBJS_COMPLEX)
	ar curv $@ $^
	cp $@ ../../lib
	
# compile 
%.real.o: %.cpp
	${CXX} ${INCPATHS} @CXXFLAGS@ ${CXX_FLAGS} @WARNINGFLAGS@ -o $@ $<
	
%.complex.o: %.cpp
	${CXX} ${INCPATHS} @CXXFLAGS@ ${CXX_FLAGS} @WARNINGFLAGS@ -o $@ $<

clean::
	-$(RM) -rf $(OBJS) $(TARGET_REAL) $(TARGET_COMPLEX)
